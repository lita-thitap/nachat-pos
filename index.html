<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nachat POS</title>
  <link rel="icon" type="image/png" href="nachatlogo.png">
  <style>
    :root{
      --bg:#111; --bg2:#1e1e1e; --panel:#fff; --raised:#fafafa; --line:#e9e9e9;
      --black:#111; --muted:#707070; --brand:#111;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--black);font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto}

    header{background:linear-gradient(#1c1c1c,#1a1a1a);color:#fff;border-bottom:1px solid #000}
    .wrap{max-width:1200px;margin:0 auto;padding:16px}
    .head-row{display:flex;align-items:center;gap:12px;justify-content:center}
    .header-logo{height:56px;width:56px;object-fit:contain;border-radius:8px}
    h1{margin:0;font-size:24px;font-weight:800}
    .sub{margin-top:6px;text-align:center;color:#d5d5d5}

    .tabs{display:flex;gap:8px;flex-wrap:wrap;max-width:1200px;margin:16px auto 0;padding:0 16px}
    .tab{padding:10px 14px;border:1.5px solid var(--black);border-radius:12px;background:#fff;cursor:pointer}
    .tab.active{outline:2px solid var(--black);background:var(--raised)}
    .content{max-width:1200px;margin:12px auto;padding:0 16px 32px}

    .card{background:#fff;border:1px solid var(--line);border-radius:16px;padding:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .row{display:flex;gap:10px;align-items:center}
    .row > *{flex:1}
    .right{display:flex;justify-content:flex-end}
    .muted{color:var(--muted)}

    .btn{padding:9px 12px;border-radius:12px;border:1.5px solid var(--black);background:#fff;color:#111;cursor:pointer}
    .btn.primary{background:#111;color:#fff}
    .btn.ghost{background:transparent}
    /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏°‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) */
    .btn.warning{background:#fff7e6;border-color:#ffb020;color:#8a5a00}
    .btn.warning:hover{background:#fffaef}

    input,select{background:#fff;border:1.5px solid var(--black);color:#111;padding:9px 10px;border-radius:12px;width:100%}
    .pill{padding:6px 10px;border-radius:999px;border:1.5px solid var(--black);background:#fff;color:#111}

    .menu-column .item{background:#111;color:#fff;border-radius:14px;padding:10px 12px;border:1px solid #000;cursor:pointer}
    .menu-column .item .price{display:inline-block;margin-left:10px;padding:2px 8px;border-radius:999px;background:#fff;color:#111;border:1px solid #111}

    .bill-row{display:grid;grid-template-columns:1fr 160px 360px;gap:10px;align-items:center}
    .bill-actions{display:flex;gap:8px;justify-content:flex-end}

    .subtabs{display:flex;gap:8px;margin-bottom:12px}
    .subtab{padding:8px 10px;border:1.5px solid var(--black);border-radius:10px;background:#fff;cursor:pointer}
    .subtab.active{outline:2px solid var(--black);background:var(--raised)}

    dialog{border:none;border-radius:16px;max-width:520px;width:96%}
    dialog::backdrop{background:rgba(0,0,0,.35)}

    .report-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .report-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .kpi{background:#fff;border:1px solid var(--line);border-radius:16px;padding:12px}
    .kpi h2{margin:0 0 6px 0;font-size:18px}
    .kpi .big{font-size:34px;font-weight:800}
    .top-list li{display:flex;justify-content:space-between;border-bottom:1px dashed var(--line);padding:6px 0}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px 8px;border-bottom:1px solid var(--line);text-align:left}

    /* QR block */
    .qr-wrap{width:220px}
    .qr-wrap img{display:block;width:100%;height:auto;border-radius:10px;border:1px solid #ddd}
    /* ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á QR ‡∏´‡∏≤‡∏¢‡πÄ‡∏Å‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ hidden */
    #qrBox[hidden]{display:none !important;}
    /* ‡∏à‡∏±‡∏î‡πÅ‡∏ô‡∏ß/‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á QR block */
    #qrBox{gap:10px;align-items:flex-start;}
    /* ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡πÇ‡∏ô‡πâ‡∏ï‡∏î‡πâ‡∏ß‡∏¢ \n (‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏ä‡πâ textContent) */
    #qrNote{white-space:pre-line;}
  </style>
</head>
<body>

  <header>
    <div class="wrap">
      <div class="head-row">
        <img src="nachatlogo.png" alt="Nachat Logo" class="header-logo" />
        <h1>‡∏ì‡∏â‡∏±‡∏ï‡∏£ | Nachat ‚Äì POS</h1>
      </div>
      <div class="sub">‡∏£‡∏∞‡∏ö‡∏ö Nachat POS ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏∞‡∏ó‡∏∞ ‚Äú‡∏ì‡∏â‡∏±‡∏ï‡∏£‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô ‚Äì ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå ‚Äì ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
    </div>
  </header>

  <div class="tabs">
    <button class="tab active" data-tab="#pos">‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
    <button class="tab" data-tab="#open">‡πÇ‡∏ï‡πä‡∏∞/‡∏ö‡∏¥‡∏•</button>
    <button class="tab" data-tab="#reports">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢</button>
    <button class="tab" data-tab="#settings">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏ô</button>
  </div>

  <div class="content">
    <!-- POS -->
    <section id="pos" class="tabpane">
      <div class="card">
        <div class="row">
          <div><label class="muted">‡πÇ‡∏ï‡πä‡∏∞</label><input id="inpTable" placeholder="‡πÄ‡∏ä‡πà‡∏ô N1" /></div>
          <div><label class="muted">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label><input id="inpStaff" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" /></div>
          <div style="max-width:160px;align-self:end"><button id="btnOpenBill" class="btn primary">‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•</button></div>
        </div>
      </div>

      <div style="height:8px"></div>
      <div id="menuPanels" class="grid"></div>

      <div style="height:8px"></div>
      <div class="card">
        <h3>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</h3>
        <div id="cartList" class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
        <div class="row" style="margin-top:8px">
          <div class="pill">‡∏£‡∏ß‡∏°: <b id="cartTotal">0</b> ‡∏ö‡∏≤‡∏ó</div>
          <div class="right" style="flex:1;gap:8px">
            <button id="btnClearCart" class="btn ghost">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
            <button id="btnAddToBill" class="btn primary">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ö‡∏¥‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
          </div>
        </div>
      </div>
    </section>

    <!-- OPEN BILLS -->
    <section id="open" class="tabpane" hidden>
      <div class="card">
        <h3>‡∏ö‡∏¥‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà</h3>
        <div id="openBills" style="display:grid;gap:10px"></div>
      </div>
    </section>

    <!-- REPORTS -->
    <section id="reports" class="tabpane" hidden>
      <div class="right" style="margin:8px 0">
        <button id="btnResetSales" class="btn warning">üßæ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äú‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‚Äù ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      </div>

      <div class="card">
        <div class="row" style="gap:8px;align-items:end">
          <div>
            <label class="muted">‡∏ä‡πà‡∏ß‡∏á</label>
            <select id="selPreset">
              <option value="month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</option>
              <option value="today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</option>
              <option value="7d">7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</option>
              <option value="custom">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</option>
            </select>
          </div>
          <div><label class="muted">‡∏à‡∏≤‡∏Å</label><input type="date" id="dFrom"></div>
          <div><label class="muted">‡∏ñ‡∏∂‡∏á</label><input type="date" id="dTo"></div>
          <div class="right"><button id="btnExportCsv" class="btn">Export CSV</button></div>
        </div>

        <div style="height:10px"></div>

        <div class="row" style="gap:10px; align-items:center">
          <div><b>Google Sheets Sync</b><div class="muted">Web App URL (Apps Script)</div></div>
          <input id="inpWebAppUrl" placeholder="https://script.google.com/macros/s/‚Ä¶/exec" />
          <select id="selSyncMode" style="max-width:220px">
            <option value="auto">Auto: ‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏ã‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏•‡∏¢</option>
            <option value="manual">Manual: ‡∏ã‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏≠‡∏á</option>
          </select>
          <button id="btnSaveUrl" class="btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
          <button id="btnTest" class="btn">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
          <button id="btnPushPending" class="btn primary">‡∏ã‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á</button>
        </div>
        <div id="gsStatus" class="muted" style="margin-top:6px"></div>
      </div>

      <div style="height:10px"></div>

      <div class="report-grid">
        <div class="report-cards">
          <div class="kpi">
            <h2>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</h2>
            <div class="big" id="kpiSum">‡∏ø0</div>
            <div class="muted">‡∏ö‡∏¥‡∏•‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: <span id="kpiAvg">‡∏ø0</span></div>
          </div>
          <div class="kpi">
            <h2>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•</h2>
            <div class="big" id="kpiBills">0</div>
            <div class="muted">‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
          </div>
        </div>

        <div class="card">
          <h3>Top ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</h3>
          <ul id="topList" class="top-list" style="list-style:none;padding:0;margin:0"></ul>
        </div>
      </div>

      <div style="height:10px"></div>

      <div class="card">
        <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏•</h3>
        <div id="salesTableBox">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
      </div>
    </section>

    <!-- SETTINGS -->
    <section id="settings" class="tabpane" hidden>
      <div class="card">
        <h3>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏ô‡∏π (‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î)</h3>
        <div class="row" style="gap:8px;margin-bottom:8px">
          <input id="newName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡πá‡∏ß‡πÜ" />
          <input id="newPrice" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤" style="max-width:140px" />
          <select id="newCat" style="max-width:220px">
            <option value="SET">‡∏ä‡∏∏‡∏î‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏∞‡∏ó‡∏∞</option>
            <option value="AD">Add-on</option>
            <option value="DW">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</option>
            <option value="PR">‡πÇ‡∏õ‡∏£‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</option>
          </select>
          <input id="newCode" placeholder="‡∏£‡∏´‡∏±‡∏™ (‡πÄ‡∏ä‡πà‡∏ô Z99)" style="max-width:140px" />
          <button id="btnAddMenu" class="btn primary">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
        </div>

        <div class="right" style="gap:8px;margin-bottom:8px">
          <button id="btnRestoreMenu" class="btn">‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
        </div>

        <div id="menuTableBox" class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π ‚Äî ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div>
      </div>
    </section>
  </div>

  <!-- Pay modal -->
  <dialog id="payModal">
    <form method="dialog" class="card" style="border:none">
      <h3>‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•</h3>

      <div class="row">
        <div><label class="muted">‡πÇ‡∏ï‡πä‡∏∞</label><input id="payTable" readonly /></div>
        <div><label class="muted">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label><input id="payStaff" readonly /></div>
      </div>

      <div style="height:6px"></div>
      <div><label class="muted">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label><input id="payTotal" readonly /></div>
      <div style="height:6px"></div>

      <div class="row">
        <div style="flex:1">
          <label class="muted">‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
          <select id="payMethod" style="width:100%">
            <option value="cash">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
            <option value="scan">‡πÇ‡∏≠‡∏ô/‡∏™‡πÅ‡∏Å‡∏ô</option>
          </select>
        </div>
        <div style="flex:1">
          <label class="muted">‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</label>
          <input id="payReceived" type="number" placeholder="‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤ (‡∏ö‡∏≤‡∏ó)" />
        </div>
        <div style="flex:1">
          <label class="muted">‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</label>
          <input id="payChange" readonly placeholder="‡∏ø0" />
        </div>
      </div>

      <div id="qrBox" class="row" style="margin-top:6px" hidden>
        <div class="qr-wrap">
          <img id="qrImg" alt="QR" />
        </div>
        <div id="qrNote" class="muted" style="margin-left:10px"></div>
      </div>

      <div class="row" style="margin-top:6px;align-items:center">
        <label class="muted" style="display:flex;align-items:center;gap:8px">
          <input type="checkbox" id="printReceiptChk"> ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏¥‡∏•‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•
        </label>
      </div>

      <div class="right" style="gap:8px;margin-top:10px">
        <button class="btn" value="cancel">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button id="btnConfirmPay" class="btn primary" value="ok">‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•</button>
      </div>
    </form>
  </dialog>

  <script>
    // Tabs
    document.querySelectorAll('.tab').forEach(btn=>{
      btn.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
        btn.addEventListener('click',()=>{});
        btn.classList.add('active');
        document.querySelectorAll('.tabpane').forEach(p=>p.hidden=true);
        document.querySelector(btn.dataset.tab).hidden=false;
        if(btn.dataset.tab==='#reports'){ window.renderReports?.(); }
      });
    });
  </script>

  <script src="app.js"></script>
  <script src="sync.js"></script>
</body>
</html>
