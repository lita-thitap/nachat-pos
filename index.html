<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ณฉัตร | Nachat POS (Offline-first)</title>
  <style>
    /* ====== Dark Gray Theme ====== */
    :root{
      --black:#111;
      --gray:#222;
      --white:#fff;
      --muted:#777;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      background:#f5f5f5;
      color:var(--black);
      font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto;
    }

    /* Header */
    header{
      background:linear-gradient(to bottom,#222,#1a1a1a);
      color:#fff;
      text-align:center;
      padding:22px 16px 28px;
    }
    .header-wrap{max-width:900px;margin:0 auto;}
    .header-logo{
      height:80px;
      border-radius:8px;
      display:block;
      margin:0 auto 6px;
    }
    .header-title{
      font-size:20px;
      font-weight:700;
      margin:0;
    }
    .header-sub{
      font-size:13px;
      color:#ccc;
    }

    /* Layout */
    .wrap{max-width:1100px;margin:16px auto;padding:0 14px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .tab{
      padding:10px 14px;
      border:1px solid #111;
      border-radius:12px;
      background:#fff;
      cursor:pointer;
      color:#111;
    }
    .tab.active{background:#111;color:#fff}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .card{background:#fff;border:1px solid #ddd;border-radius:16px;padding:12px}
    .card h3{margin:0 0 8px;font-size:15px}

    .row{display:flex;gap:10px;align-items:center}
    .row > *{flex:1}

    .btn{
      padding:9px 12px;
      border-radius:12px;
      border:1px solid #111;
      background:#fff;
      color:#111;
      cursor:pointer;
      font-size:13px;
    }
    .btn.primary{background:#111;color:#fff}
    .btn.ghost{background:transparent}
    .btn.danger{border-color:#a00;color:#a00;background:transparent}

    input,select{
      background:#fff;border:1px solid #111;color:#111;
      padding:9px 10px;border-radius:12px;width:100%;
    }
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px dashed #ddd;padding:8px;text-align:left}
    tfoot td{font-weight:700}
    .muted{color:var(--muted)}
    .pill{
      padding:5px 10px;
      border-radius:999px;
      border:1px solid var(--black);
      background:#fff;
      color:var(--black);
      font-size:13px;
    }
    .space{height:10px}
    .mini{font-size:12px;color:var(--muted)}

    /* Subtabs */
    .subtabs{display:flex;gap:6px;margin-bottom:10px}
    .subtab{
      padding:7px 10px;border:1px solid #111;
      border-radius:10px;background:#fff;cursor:pointer;
    }
    .subtab.active{background:#111;color:#fff}

    /* ปรับ layout เฉพาะบิลเปิดอยู่ */
    #openBills .row > *{ flex:0 0 auto; }
    #openBills .row{ flex-wrap:wrap; gap:10px; align-items:center; }
    #openBills .total{ margin-left:auto; }

  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-wrap">
      <img src="LOGO NACHAT.png" alt="Nachat Logo" class="header-logo" />
      <h1 class="header-title">ณฉัตร | Nachat – POS</h1>
      <div class="header-sub">หมูกระทะชุดละ 299 + Add-on & เครื่องดื่ม | สรุปยอดขายรายวัน / สัปดาห์ / เดือน</div>
    </div>
  </header>

  <!-- Main Body -->
  <div class="wrap">
    <div class="tabs">
      <button class="tab active" data-tab="#pos">รับออเดอร์</button>
      <button class="tab" data-tab="#open">โต๊ะ/บิล</button>
      <button class="tab" data-tab="#reports">รายงานขาย</button>
      <button class="tab" data-tab="#settings">ตั้งค่าร้าน</button>
    </div>

    <!-- POS TAB -->
    <section id="pos" class="tabpane">
      <div class="card">
        <div class="row">
          <div><label class="muted">โต๊ะ</label><input id="inpTable" placeholder="เช่น N1"/></div>
          <div><label class="muted">พนักงาน</label><input id="inpStaff" placeholder="เช่น น้ำชา"/></div>
          <div style="max-width:160px;align-self:end"><button class="btn primary" id="btnOpenBill">เปิดบิล</button></div>
        </div>
      </div>

      <div class="space"></div>
      <div id="menuPanels" class="grid"></div>

      <div class="space"></div>
      <div class="card">
        <h3>ตะกร้า</h3>
        <div id="cartList" class="muted">ยังไม่มีรายการ</div>
        <div class="row" style="margin-top:6px">
          <div class="pill">รวม: <b id="cartTotal">0</b> บาท</div>
          <div class="right" style="flex:1; gap:8px">
            <button class="btn ghost" id="btnClearCart">ล้างตะกร้า</button>
            <button class="btn primary" id="btnAddToBill">เพิ่มลงบิลปัจจุบัน</button>
          </div>
        </div>
      </div>
    </section>

    <!-- OPEN BILLS TAB -->
    <section id="open" class="tabpane" hidden>
      <div class="card">
        <h3>บิลที่เปิดอยู่</h3>
        <div id="openBills"></div>
      </div>
    </section>

    <!-- REPORTS TAB -->
    <section id="reports" class="tabpane" hidden>
      <div class="card">
        <h3>สรุปรายงาน</h3>
        <div class="row">
          <button class="btn" id="btnToday">วันนี้</button>
          <button class="btn" id="btnMonth">เดือนนี้</button>
        </div>
        <div class="space"></div>
        <div id="reportBox" class="muted">ยังไม่มีข้อมูล</div>
      </div>
    </section>

    <!-- SETTINGS TAB -->
    <section id="settings" class="tabpane" hidden>
      <div class="subtabs">
        <button class="subtab active" data-sub="#menuSet">ตั้งค่าเมนู</button>
        <button class="subtab" data-sub="#cloudSet">เชื่อมต่อ Google Sheets</button>
      </div>

      <!-- ตั้งค่าเมนู -->
      <div id="menuSet" class="subpane">
        <div class="card">
          <h3>ตั้งค่าเมนู (จัดตามหมวด)</h3>
          <div class="row" style="gap:8px;margin-bottom:8px">
            <input id="menuSearch" placeholder="กรองตามชื่อ"/>
            <select id="menuFilter">
              <option value="">ทุกหมวด</option>
              <option value="SET">ชุดหมูกระทะ</option>
              <option value="AD">Add-on</option>
              <option value="DW">เครื่องดื่ม</option>
              <option value="PR">โปรโมชันเครื่องดื่ม</option>
            </select>
          </div>
          <div class="row" style="gap:8px;margin-bottom:8px">
            <input id="newName" placeholder="ชื่อเมนูใหม่"/>
            <input id="newPrice" type="number" placeholder="ราคา" style="max-width:140px"/>
            <select id="newCat" style="max-width:220px">
              <option value="SET">ชุดหมูกระทะ</option>
              <option value="AD">Add-on</option>
              <option value="DW">เครื่องดื่ม</option>
              <option value="PR">โปรโมชันเครื่องดื่ม</option>
            </select>
            <input id="newCode" class="col-code" placeholder="รหัส (เช่น Z99)"/>
            <button class="btn primary" id="btnAddMenu">เพิ่ม</button>
          </div>

          <div id="menuTableBox" class="mini muted">ยังไม่มีข้อมูล</div>
        </div>
      </div>

      <!-- เชื่อมต่อคลาวด์ -->
      <div id="cloudSet" class="subpane" hidden>
        <div class="card">
          <h3>เชื่อมต่อ Google Sheets (Apps Script)</h3>
          <div class="row">
            <input id="inpWebAppUrl" placeholder="https://script.google.com/macros/s/…/exec"/>
            <button class="btn" id="btnSaveUrl">บันทึก</button>
            <button class="btn" id="btnTest">ทดสอบเชื่อมต่อ</button>
          </div>
          <div id="gsStatus" class="muted" style="margin-top:8px"></div>
          <div class="space"></div>
          <div class="row"><button class="btn danger" id="btnClearLocal">ล้างข้อมูลเครื่องนี้</button></div>
        </div>
      </div>
    </section>
  </div>

  <script src="app.js"></script>
  <script src="sync.js"></script>
  <script>
    // Tabs
    document.querySelectorAll('.tab').forEach(btn=>{
      btn.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.tabpane').forEach(p=>p.hidden=true);
        document.querySelector(btn.dataset.tab).hidden=false;
      });
    });
    // Subtabs
    document.querySelectorAll('.subtab').forEach(btn=>{
      btn.addEventListener('click',()=>{
        document.querySelectorAll('.subtab').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.subpane').forEach(p=>p.hidden=true);
        document.querySelector(btn.dataset.sub).hidden=false;
      });
    });
  </script>
</body>
</html>
