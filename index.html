<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nachat POS (Offline-first)</title>
  <style>
    :root{
      --black:#111; --white:#fff; --muted:#6b6b6b;
      --panel:#fff; --line:#eaeaea; --bg:#0e0e0e; --raised:#fafafa;
      --accent:#111;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--black);
      font:14px/1.55 ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto;
    }
    a{color:inherit}

    /* Header */
    header{background:linear-gradient(#1e1e1e,#141414); color:#fff}
    .wrap{max-width:1100px;margin:0 auto;padding:20px 16px}
    .header-bar{display:flex;gap:14px;align-items:center}
    .header-logo{height:64px;width:64px;border-radius:12px;background:#fff;object-fit:contain}
    .header-title{display:flex;flex-direction:column}
    .header-title h1{margin:0;font-size:22px;font-weight:800}
    .header-title .sub{color:#cfcfcf;margin-top:4px}

    /* Tabs */
    .tabs{display:flex;gap:10px;flex-wrap:wrap;margin:14px 0}
    .tab{padding:10px 14px;border:1.5px solid #111;border-radius:14px;background:#fff;cursor:pointer}
    .tab.active{background:#f9f9f9;outline:2px solid #000}

    /* Shell */
    main{background:#f4f5f6;border-top:1px solid #000}
    .container{max-width:1100px;margin:0 auto;padding:16px}

    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
    @media(max-width:980px){ .grid{grid-template-columns:1fr} }

    .card{background:#fff;border:1px solid #eaeaea;border-radius:16px;padding:16px}

    .btn{padding:10px 14px;border-radius:12px;border:1.5px solid #111;background:#fff;cursor:pointer}
    .btn.primary{background:#111;color:#fff}
    .btn.danger{background:#fff;border-color:#c1121f;color:#c1121f}
    input,select{width:100%;padding:10px;border:1.5px solid #111;border-radius:12px;background:#fff}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px dashed #e5e5e5;text-align:left}
    tfoot td{font-weight:700}
    .pill{padding:6px 10px;border-radius:999px;border:1.5px solid #111;background:#fff}

    /* ==== PAYMENT MODAL ==== */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.6);z-index:50}
    .modal.show{display:grid}
    .modal-box{width:min(980px,95vw);max-height:90vh;overflow:auto;
      background:#fff;border-radius:16px;border:1px solid #ddd;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .modal-header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid #eee}
    .modal-body{padding:16px}
    .close-x{border:none;background:#eee;width:36px;height:36px;border-radius:10px;cursor:pointer}

    .row{display:flex;gap:10px;align-items:center}
    .row > *{flex:1}
    .right{display:flex;justify-content:flex-end;gap:8px}

    /* Printable receipt page */
    @media print {
      .no-print { display:none !important; }
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="header-bar">
        <img src="LOGO NACHAT.png" alt="Nachat Logo" class="header-logo"/>
        <div class="header-title">
          <h1>ณฉัตร | Nachat – POS</h1>
          <div class="sub">หมูกระทะชุดละ 299 + Add-on & เครื่องดื่ม | สรุปยอดขายรายวัน/สัปดาห์/เดือน</div>
        </div>
      </div>
      <div class="tabs">
        <button class="tab active" data-tab="#pos">รับออเดอร์</button>
        <button class="tab" data-tab="#open">โต๊ะ/บิล</button>
        <button class="tab" data-tab="#reports">รายงานขาย</button>
        <button class="tab" data-tab="#settings">ตั้งค่าร้าน</button>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <!-- POS + BILLS -->
      <div class="grid">
        <section id="pos" class="tabpane">
          <div class="card">
            <div class="row">
              <div><label>โต๊ะ</label><input id="inpTable" placeholder="เช่น A1"/></div>
              <div><label>พนักงาน</label><input id="inpStaff" placeholder="เช่น Koch"/></div>
              <div style="max-width:160px;align-self:end"><button class="btn primary" id="btnOpenBill">เปิดบิล</button></div>
            </div>
          </div>

          <div style="height:10px"></div>
          <div id="menuPanels" class="card"><b>เมนู</b><div id="menuList" style="margin-top:8px"></div></div>

          <div style="height:10px"></div>
          <div class="card">
            <div class="row">
              <div class="pill">ตะกร้า: <b id="cartTotal">0</b> บาท</div>
              <div class="right">
                <button class="btn" id="btnClearCart">ล้างตะกร้า</button>
                <button class="btn primary" id="btnAddToBill">เพิ่มลงบิลปัจจุบัน</button>
              </div>
            </div>
            <div id="cartList" style="margin-top:10px;color:#555">ยังไม่มีรายการ</div>
          </div>
        </section>

        <section id="open" class="tabpane" hidden>
          <div class="card">
            <h3>บิลที่เปิดอยู่</h3>
            <div id="openBills"></div>
          </div>
        </section>
      </div>

      <div style="height:14px"></div>

      <section id="reports" class="tabpane" hidden>
        <div class="card">
          <h3>สรุปยอดขาย</h3>
          <div class="row">
            <button class="btn" id="btnToday">วันนี้</button>
            <button class="btn" id="btnMonth">เดือนนี้</button>
            <button class="btn" id="btnPullNow">ดึงจากคลาวด์</button>
          </div>
          <div id="reportBox" style="margin-top:10px;color:#555">ยังไม่มีข้อมูล</div>
        </div>
      </section>

      <section id="settings" class="tabpane" hidden>
        <div class="card">
          <h3>ตั้งค่าเมนู / ข้อมูลร้าน</h3>
          <div class="row">
            <div><label>ชื่อร้าน</label><input id="shopName" placeholder="ณฉัตร | Nachat"/></div>
            <div><label>บัญชีธนาคาร (แสดงบนสลิป)</label><input id="bankLine" placeholder="KBANK • กชพร ทรัพย์คงเดช"/></div>
          </div>
          <div class="row" style="margin-top:8px">
            <div><label>PromptPay (เบอร์/เลข)</label><input id="ppId" placeholder="0813238287"/></div>
            <div><label>Web App URL (Apps Script /exec)</label><input id="gsUrl" placeholder="https://script.google.com/macros/s/.../exec"/></div>
          </div>
          <div class="right" style="margin-top:8px">
            <button class="btn" id="btnSaveSettings">บันทึก</button>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- ===== Payment Modal ===== -->
  <div id="payModal" class="modal no-print" aria-hidden="true">
    <div class="modal-box">
      <div class="modal-header">
        <b>ปิดบิล</b>
        <button class="close-x" id="payClose">✕</button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div><label>โต๊ะ</label><input id="payTable" disabled/></div>
          <div><label>พนักงาน</label><input id="payStaff" disabled/></div>
          <div><label>ยอดรวม</label><input id="payTotal" disabled/></div>
        </div>

        <div style="height:10px"></div>

        <table id="payItems">
          <thead><tr><th>รายการ</th><th style="width:80px">จำนวน</th><th style="width:110px">รวม</th></tr></thead>
          <tbody></tbody>
        </table>

        <div style="height:10px"></div>
        <div class="row">
          <div>
            <label>วิธีชำระ</label>
            <select id="payMethod">
              <option value="cash">เงินสด (Cash)</option>
              <option value="transfer">โอน</option>
            </select>
          </div>
          <div><label>รับเงินมา (บาท)</label><input id="payReceive" type="number" min="0" /></div>
          <div><label>เงินทอน</label><input id="payChange" disabled/></div>
        </div>

        <div id="qrBox" style="margin-top:12px;display:none">
          <img id="qrImg" alt="QR" style="width:180px;height:180px;image-rendering:pixelated;border-radius:8px;border:1px solid #eee;background:#fff"/>
          <div style="color:#666;margin-top:4px">สแกนจ่ายได้เลย</div>
        </div>

        <div class="right" style="margin-top:14px">
          <button class="btn" id="btnViewSlip">ดูสลิป/พิมพ์</button>
          <button class="btn danger" id="btnVoidBill">ยกเลิกบิล</button>
          <button class="btn primary" id="btnPayConfirm">ปิดบิล</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
  <script src="sync.js"></script>
  <script>
    // Tabs
    document.querySelectorAll('.tab').forEach(btn=>{
      btn.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active')); btn.classList.add('active');
        document.querySelectorAll('.tabpane').forEach(p=>p.hidden=true); document.querySelector(btn.dataset.tab).hidden=false;
      });
    });
  </script>
</body>
</html>
